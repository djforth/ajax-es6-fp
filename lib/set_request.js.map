{"version":3,"sources":["../src/set_request.js"],"names":["_","require","checkStatus","errorFn","parseData","progressFn","successFn","readyState","addError","xhr","err","addEventListener","evt","error","message","addProgress","prog","check_prog","loaded","total","lengthComputable","addReadyState","stateChange","module","exports","resolve","reject","suc","XMLHttpRequest","obj","progress","isFunction","get","open","state","url","send","data","JSON","stringify"],"mappings":";;AAAA,IAAMA,IAAIC,QAAQ,aAAR,CAAV;;AAEA,IAAMC,cAAcD,QAAQ,gBAAR,CAApB;AAAA,IACOE,UAAaF,QAAQ,gBAAR,CADpB;AAAA,IAEOG,YAAaH,QAAQ,SAAR,CAFpB;AAAA,IAGOI,aAAeJ,QAAQ,gBAAR,CAHtB;AAAA,IAIOK,YAAaL,QAAQ,kBAAR,CAJpB;AAAA,IAKOM,aAAaN,QAAQ,eAAR,CALpB;;AAOA,SAASO,QAAT,CAAkBC,GAAlB,EAAuBC,GAAvB,EAA2B;AACzBD,MAAIE,gBAAJ,CAAqB,OAArB,EAA8B,UAASC,GAAT,EAAa;AACzCF,4BAAsBE,IAAIC,KAAJ,CAAUC,OAAhC;AACD,GAFD;;AAIAL,MAAIE,gBAAJ,CAAqB,OAArB,EAA8B,UAASC,GAAT,EAAa;AACzCF,4BAAsBE,IAAIC,KAAJ,CAAUC,OAAhC;AACD,GAFD;AAGD;;AAED,SAASC,WAAT,CAAqBN,GAArB,EAA0BO,IAA1B,EAA+B;AAC7B,MAAIC,aAAaZ,WAAWW,IAAX,CAAjB;AACAP,MAAIE,gBAAJ,CAAqB,UAArB,EAAiC,UAASC,GAAT,EAAa;AAC5CK,eAAWL,IAAIM,MAAf,EAAuBN,IAAIO,KAA3B,EAAkCP,IAAIQ,gBAAtC;AACD,GAFD;AAGD;;AAED,SAASC,aAAT,CAAuBZ,GAAvB,EAA4Ba,WAA5B,EAAwC;AACtCb,MAAIE,gBAAJ,CAAqB,kBAArB,EAAyC,YAAU;AACjDW,gBAAYb,GAAZ;AACD,GAFD;AAGD;;AAEDc,OAAOC,OAAP,GAAiB,UAASC,OAAT,EAAkBC,MAAlB,EAAyB;AACxC,MAAIhB,YAAJ;AAAA,MAASY,oBAAT;AAAA,MAAsBK,YAAtB;AACA,MAAMlB,MAAM,IAAImB,cAAJ,EAAZ;AACAlB,QAAMP,QAAQuB,MAAR,EAAgBtB,SAAhB,CAAN;AACAuB,QAAMrB,UAAUmB,OAAV,EAAmBrB,SAAnB,CAAN;AACAkB,gBAAcf,WAAWoB,GAAX,EAAgBjB,GAAhB,EAAqBR,WAArB,CAAd;;AAEAM,WAASC,GAAT,EAAcC,GAAd;AACAW,gBAAcZ,GAAd,EAAmBa,WAAnB;;AAEA,MAAMO,MAAM;AACVC,cAAU,kBAASd,IAAT,EAAc;AACtB,UAAI,CAAChB,EAAE+B,UAAF,CAAaf,IAAb,CAAL,EAAyB,OAAOa,GAAP;AACzBd,kBAAYN,GAAZ,EAAiBO,IAAjB;AACA,aAAOa,GAAP;AACD,KALS;AAMRG,SAAK;AAAA,aAAIvB,GAAJ;AAAA,KANG;AAORwB,UAAM,cAASC,KAAT,EAAgBC,GAAhB,EAAoB;AAC1B1B,UAAIwB,IAAJ,CAASC,KAAT,EAAgBC,GAAhB,EAAqB,IAArB;AACA,aAAON,GAAP;AACD,KAVS;AAWRO,UAAM,cAASA,KAAT,EAAc;AACpB,UAAIC,OAAQD,KAAD,GAASE,KAAKC,SAAL,CAAeH,KAAf,CAAT,GAAgC,IAA3C;AACA3B,UAAI2B,IAAJ,CAASC,IAAT;AACD;AAdS,GAAZ;;AAiBA,SAAOR,GAAP;AACD,CA5BD","file":"set_request.js","sourcesContent":["const _ = require('lodash/core');\n\nconst checkStatus = require('./check_status')\n     , errorFn    = require('./create_error')\n     , parseData  = require('./parse')\n     , progressFn   = require('./set_progress')\n     , successFn  = require('./create_success')\n     , readyState = require('./ready_state');\n\nfunction addError(xhr, err){\n  xhr.addEventListener('error', function(evt){\n    err(`Network Error: ${evt.error.message}`);\n  });\n\n  xhr.addEventListener('abort', function(evt){\n    err(`Network Abort: ${evt.error.message}`);\n  });\n}\n\nfunction addProgress(xhr, prog){\n  let check_prog = progressFn(prog);\n  xhr.addEventListener('progress', function(evt){\n    check_prog(evt.loaded, evt.total, evt.lengthComputable);\n  });\n}\n\nfunction addReadyState(xhr, stateChange){\n  xhr.addEventListener('readystatechange', function(){\n    stateChange(xhr);\n  });\n}\n\nmodule.exports = function(resolve, reject){\n  let err, stateChange, suc;\n  const xhr = new XMLHttpRequest();\n  err = errorFn(reject, parseData);\n  suc = successFn(resolve, parseData);\n  stateChange = readyState(suc, err, checkStatus);\n\n  addError(xhr, err);\n  addReadyState(xhr, stateChange);\n\n  const obj = {\n    progress: function(prog){\n      if (!_.isFunction(prog)) return obj;\n      addProgress(xhr, prog);\n      return obj;\n    }\n    , get: ()=>xhr\n    , open: function(state, url){\n      xhr.open(state, url, true);\n      return obj;\n    }\n    , send: function(send){\n      let data = (send) ? JSON.stringify(send) : null;\n      xhr.send(data);\n    }\n  };\n\n  return obj;\n};\n"]}