{"version":3,"sources":["../src/patch.js"],"names":["add_id","require","addMethod","addHeaders","getCSRF","createPromise","xhrRequest","module","exports","url","rails","csrf","data_set","headers","promise","xhr","url_id","addCSRF","token","addRails","resolve","reject","data","id","api","open","set","get","param","send"],"mappings":";;AAAA,IAAMA,SAASC,QAAQ,UAAR,CAAf;AAAA,IACMC,YAAYD,QAAQ,cAAR,CADlB;AAAA,IAEME,aAAaF,QAAQ,kBAAR,CAFnB;AAAA,IAGMG,UAAUH,QAAQ,YAAR,CAHhB;AAAA,IAIMI,gBAAgBJ,QAAQ,kBAAR,CAJtB;AAAA,IAKMK,aAAaL,QAAQ,eAAR,CALnB;;AAOAM,OAAOC,OAAP,GAAiB,UAASC,GAAT,EAA2B;AAAA,MAAbC,KAAa,uEAAL,IAAK;;AAC1C,MAAIC,aAAJ;AAAA,MAAUC,iBAAV;AAAA,MAAoBC,gBAApB;AAAA,MAA6BC,gBAA7B;AAAA,MAAsCC,YAAtC;AAAA,MAA2CC,eAA3C;AACAL,SAAOP,SAAP;AACAS,YAAUV,YAAV;;AAEAU,UAAQI,OAAR,CAAgBN,KAAKO,KAArB;AACAF,WAAShB,OAAOS,GAAP,CAAT;AACAG,aAAWV,UAAUS,IAAV,EAAgB,OAAhB,CAAX;;AAEA,MAAID,KAAJ,EAAU;AACRG,YAAQM,QAAR;AACD;;AAEDL,YAAUT,eAAV;AACAU,QAAMT,WAAWQ,QAAQM,OAAnB,EAA4BN,QAAQO,MAApC,CAAN;;AAEA,SAAO,UAASC,IAAT,EAAeC,EAAf,EAAkB;AACvB,QAAIC,MAAOD,EAAD,GAAOP,OAAOO,EAAP,CAAP,GAAoBd,GAA9B;AACAM,QAAIU,IAAJ,CAAS,KAAT,EAAgBD,GAAhB;AACAX,YAAQa,GAAR,CAAYX,IAAIY,GAAJ,EAAZ;AACAL,SAAKX,KAAKiB,KAAV,IAAmBjB,KAAKO,KAAxB;AACAH,QAAIc,IAAJ,CAASjB,SAASU,IAAT,CAAT;AACA,WAAOR,QAAQA,OAAf;AACD,GAPD;AAQD,CAxBD","file":"patch.js","sourcesContent":["const add_id = require('./add_id')\n    , addMethod = require('./add_method')\n    , addHeaders = require('./manage_headers')\n    , getCSRF = require('./get_CSRF')\n    , createPromise = require('./create_promise')\n    , xhrRequest = require('./set_request');\n\nmodule.exports = function(url, rails = true){\n  let csrf, data_set, headers, promise, xhr, url_id;\n  csrf = getCSRF();\n  headers = addHeaders();\n\n  headers.addCSRF(csrf.token);\n  url_id = add_id(url);\n  data_set = addMethod(csrf, 'patch');\n\n  if (rails){\n    headers.addRails();\n  }\n\n  promise = createPromise();\n  xhr = xhrRequest(promise.resolve, promise.reject);\n\n  return function(data, id){\n    let api = (id) ? url_id(id) : url;\n    xhr.open('PUT', api);\n    headers.set(xhr.get());\n    data[csrf.param] = csrf.token;\n    xhr.send(data_set(data));\n    return promise.promise;\n  };\n};\n"]}